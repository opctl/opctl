"use strict";(self.webpackChunkopctl=self.webpackChunkopctl||[]).push([[1643],{9847:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"run-a-react-app","title":"Run a react app","description":"We\'ll now look at an op to run a sample React application. Please see the code at https://github.com/opctl/opctl/tree/main/examples/run-a-react-app","source":"@site/docs/run-a-react-app.md","sourceDirName":".","slug":"/run-a-react-app","permalink":"/docs/run-a-react-app","draft":false,"unlisted":false,"editUrl":"https://github.com/opctl/opctl/edit/main/website/docs/run-a-react-app.md","tags":[],"version":"current","lastUpdatedBy":"Chris Dostert","lastUpdatedAt":1730760746000,"frontMatter":{"title":"Run a react app","sidebar_label":"run a react app"}}');var a=r(4848),c=r(8453);const o={title:"Run a react app",sidebar_label:"run a react app"},s=void 0,i={},p=[{value:"dev",id:"dev",level:4}];function l(e){const n={a:"a",code:"code",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["We'll now look at an op to run a sample React application. Please see the code at ",(0,a.jsx)(n.a,{href:"https://github.com/opctl/opctl/tree/main/examples/run-a-react-app",children:"https://github.com/opctl/opctl/tree/main/examples/run-a-react-app"})]}),"\n",(0,a.jsxs)(n.p,{children:["We'll stick to simple node.js conventions of including the run command in an ",(0,a.jsx)(n.code,{children:"npm start"})," script in ",(0,a.jsx)(n.code,{children:"package.json"}),". Because we used ",(0,a.jsx)(n.code,{children:"create-react-app"})," to bootstrap our project, the start script is ",(0,a.jsx)(n.code,{children:"react-scripts start"}),", which will launch the webpack dev server to serve our app for development."]}),"\n",(0,a.jsx)(n.p,{children:"Let's say our frontend React app needs to call the a go api from our previous example. When running that stack we want our services running locally (React app running via webpack, our go service, and the mysql database). We however prefer to have the ops running each service to live with the source code it runs, rather than in a separate place."}),"\n",(0,a.jsxs)(n.p,{children:["What we need our ",(0,a.jsx)(n.code,{children:"dev"})," op to do then is to:"]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["call ",(0,a.jsx)(n.code,{children:"go-svc"}),"'s ",(0,a.jsx)(n.code,{children:"dev"})," op by remote reference"]}),"\n",(0,a.jsx)(n.li,{children:"run our React app in a container"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["So our ops in ",(0,a.jsx)(n.code,{children:"run-a-react-app"})," would look like this"]}),"\n",(0,a.jsx)(n.h4,{id:"dev",children:"dev"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"name: dev\ndescription: runs react-app for development\nrun:\n  parallel:\n    - op:\n        # reference run-a-go-service dev op\n        ref: $(../../../run-a-go-service/.opspec/dev)\n    - container:\n        image:\n          ref: 'node:20-alpine'\n        cmd:\n          - sh\n          - -ce\n          - yarn && yarn run start\n        dirs:\n          /src: $(../..)\n        # this sets an opctl DNS A record so the containers available via this name.\n        name: run-a-react-app-ui\n        workDir: /src\n"})}),"\n",(0,a.jsxs)(n.p,{children:["going to ",(0,a.jsx)(n.a,{href:"http://run-a-go-service-api",children:"http://run-a-go-service-api"})," should show us the ",(0,a.jsx)(n.code,{children:"go-svc"})," api being served, and ",(0,a.jsx)(n.a,{href:"http://run-a-react-app-ui:3000",children:"http://run-a-react-app-ui:3000"})," should show us the react app, which in turns is making a call to ",(0,a.jsx)(n.code,{children:"go-svc"})," and fetching data to show."]}),"\n",(0,a.jsx)(n.p,{children:"Notice the following:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["we're referencing the ",(0,a.jsx)(n.code,{children:"dev"})," op from the go-svc."]}),"\n",(0,a.jsxs)(n.li,{children:["we can run our ops in any combination of ",(0,a.jsx)(n.code,{children:"parallel"})," and ",(0,a.jsx)(n.code,{children:"serial"})," blocks, composing them as needed. for our case the ",(0,a.jsx)(n.code,{children:"dev"})," op can run in the background while we init then run our react app"]}),"\n",(0,a.jsxs)(n.li,{children:['networking between our services "just works" by referencing containers by name, so the webpack dev server proxy configuration in ',(0,a.jsx)(n.code,{children:"package.json"})," targets ",(0,a.jsx)(n.code,{children:"run-a-go-service-api"}),":"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'"proxy": {\n    "/api": {\n      "target": "http://run-a-go-service-api"\n    }\n  }\n'})})]})}function d(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>s});var t=r(6540);const a={},c=t.createContext(a);function o(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);